# SplitBase 好友功能说明

## 功能概述

SplitBase 现在支持好友管理功能，让用户可以：

- 添加和管理好友联系人
- 在创建账单时选择好友作为参与者
- 自动将新地址添加为好友（如果不存在）

## 主要功能

### 1. 好友管理页面 (`/friends`)

- **添加好友**: 输入钱包地址、Base名称、显示名称和昵称
- **编辑好友**: 修改好友的显示名称、昵称和收藏状态
- **删除好友**: 移除不需要的好友
- **收藏好友**: 标记常用好友，优先显示
- **搜索好友**: 按地址、名称或昵称搜索

### 2. 好友选择器组件

在创建账单时，用户可以选择：

- **手动计数模式**: 传统的人数输入方式
- **好友选择模式**: 从好友列表中选择参与者

### 3. 自动好友添加

当用户在创建账单时输入新地址：

- 如果地址已存在于好友列表中，直接选择
- 如果地址不存在，自动创建新好友并添加到选择列表

## 使用方法

### 添加好友

1. 导航到 `/friends` 页面
2. 点击 "Add New Friend" 按钮
3. 填写好友信息：
   - 钱包地址（必填）
   - Base名称（可选）
   - 显示名称（可选）
   - 昵称（可选）
4. 点击 "Add Friend" 保存

### 在创建账单时使用好友

1. 导航到创建账单页面
2. 选择 "Select Friends" 模式
3. 从好友列表中选择参与者
4. 或者输入新地址自动添加好友

### 管理好友

- **编辑**: 点击好友卡片上的编辑按钮
- **删除**: 点击删除按钮确认删除
- **收藏**: 点击星形图标切换收藏状态
- **搜索**: 使用搜索框快速找到特定好友

## 技术实现

### 数据存储

- 使用 localStorage 存储好友数据
- 按用户地址分别存储，确保数据隔离
- 支持离线使用

### 组件架构

- `FriendsPage`: 好友管理主页面
- `FriendSelector`: 好友选择组件
- `FriendCard`: 好友信息卡片组件
- `friend-utils.ts`: 好友管理工具函数

### API 接口

- `GET /api/friends`: 获取好友列表
- `POST /api/friends`: 添加新好友
- `PUT /api/friends`: 更新好友信息
- `DELETE /api/friends`: 删除好友

## 数据模型

```typescript
interface Friend {
  id: string;
  address: string;
  basename?: string;
  displayName?: string;
  nickname?: string;
  addedAt: Date;
  lastUsedAt?: Date;
  isFavorite?: boolean;
}
```

## 注意事项

1. **地址验证**: 自动验证以太坊地址格式
2. **重复检查**: 防止添加重复地址
3. **数据持久化**: 数据存储在用户本地，清除浏览器数据会丢失
4. **隐私保护**: 好友数据仅存储在用户本地，不上传到服务器

## 未来改进

- [ ] 支持好友分组
- [ ] 导入/导出好友列表
- [ ] 好友头像和更多个人信息
- [ ] 云端同步好友数据
- [ ] 好友活动历史记录
